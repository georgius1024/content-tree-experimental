import{d as $,r,b as g,U as I,o as T,M as B,y as l,A as n,I as F,H as E,u as P,G as j,C as v,D as i,F as R,K as A,z as a}from"./vue-vendor-DSdsonjH.js";import{g as V,c as z,C as D}from"./index-CLhcb0aJ.js";import{_ as L}from"./RichTextView.vue_vue_type_script_setup_true_lang-CMYdHiiQ.js";import{_ as M}from"./TreeBreadcrumb.vue_vue_type_script_setup_true_lang-Cu-qd2mu.js";import"./ui-BLgiSNLv.js";const O={class:"rounded-lg border border-gray-200 bg-white shadow-sm"},S={class:"px-4 py-2 border-b border-gray-200"},W=["onClick"],G={key:1,class:"truncate max-w-40 inline-block align-middle"},H={class:"p-4 mx-auto max-w-5xl"},K={class:"text-lg font-semibold mb-3"},U={key:1,class:"mt-4 space-y-2"},q={class:"space-y-1"},J={class:"text-sm text-gray-900"},Q={class:"text-xs font-semibold text-white bg-blue-600 px-2 py-0.5 rounded-full shrink-0"},ne=$({__name:"CoursePage",setup(X){const u=B(),y=I(),b=D,f=r([]),x=g(()=>y.params.path||""),c=g(()=>{const s=x.value;return s.endsWith("/")?`/${s}`:`/${s}/`}),k=g(()=>c.value.split("/").filter(Boolean).length),d=r(""),p=r(""),m=r(""),h=r([]),w=s=>{const e=s.split("/").filter(Boolean).map(o=>Number(o)).filter(Number.isFinite),t=e.length>0?e[e.length-1]:void 0;return t??null},_=s=>{const e=s.endsWith("/")?s:`${s}/`;u.push({path:e})},C=()=>{u.push({path:`/course-editor${m.value}`})},N=()=>{u.push({path:`/course-preview${m.value}`})};return T(async()=>{f.value=await V(b);const s=w(c.value),e=s!=null?f.value.find(o=>o.id===s&&o.deletedAt===null):null;if(!e||e.type!=="leaf"){u.push({path:"/"});return}m.value=e.path,d.value=e.name;const t=typeof e.objectId=="string"?e.objectId:null;if(t){const o=z(t);o&&o.deletedAt===null&&(d.value=o.fullName||e.name,p.value=o.description||"",h.value=o.structure||[])}}),(s,e)=>(a(),l("div",O,[n("div",S,[F(M,{"forest-id":P(b),path:c.value,onRootClick:e[0]||(e[0]=t=>_("/"))},{item:E(({item:t,index:o})=>[o<k.value-1?(a(),l("button",{key:0,class:"truncate max-w-40 inline-block align-middle hover:underline",onClick:Y=>_(t.path)},i(t.name),9,W)):(a(),l("span",G,i(t.name),1))]),_:1},8,["forest-id","path"])]),n("div",H,[n("h1",K,i(d.value),1),p.value?(a(),j(L,{key:0,content:p.value},null,8,["content"])):v("",!0),h.value.length>0?(a(),l("div",U,[n("ul",q,[(a(!0),l(R,null,A(h.value,t=>(a(),l("li",{key:t.id,class:"flex items-center justify-between px-0 py-2 rounded-md"},[n("span",J,i(t.name),1),n("span",Q,i(t.steps.length),1)]))),128))])])):v("",!0),n("div",{class:"flex gap-2 justify-end mt-4"},[n("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",onClick:C}," Edit "),n("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",onClick:N}," Preview ")])])]))}});export{ne as default};
