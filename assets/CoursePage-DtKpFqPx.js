import{d as T,E as B,r as c,b as _,U as F,o as E,M as j,y as r,A as n,I as P,H as R,u as g,G as A,C as x,D as a,F as V,K as z,z as l}from"./vue-vendor-DSdsonjH.js";import{g as D,c as L,C as M}from"./index-BzoJvuOE.js";import{_ as O}from"./RichTextView.vue_vue_type_script_setup_true_lang-CMYdHiiQ.js";import{_ as S}from"./TreeBreadcrumb.vue_vue_type_script_setup_true_lang-Pa4JiHdF.js";import"./ui-BLgiSNLv.js";const W={class:"rounded-lg border border-gray-200 bg-white shadow-sm"},G={class:"px-4 py-2 border-b border-gray-200"},H=["onClick"],K={key:1,class:"truncate max-w-40 inline-block align-middle"},U={class:"p-4 mx-auto max-w-5xl"},q={class:"text-lg font-semibold mb-3"},J={key:1,class:"mt-4 space-y-2"},Q={class:"space-y-1"},X={class:"text-sm text-gray-900"},Y={class:"text-xs font-semibold text-white bg-blue-600 px-2 py-0.5 rounded-full shrink-0"},Z={class:"flex gap-2 justify-end mt-4"},re=T({__name:"CoursePage",setup(ee){const{t:b}=B(),i=j(),k=F(),f=M,v=c([]),w=_(()=>k.params.path||""),u=_(()=>{const s=w.value;return s.endsWith("/")?`/${s}`:`/${s}/`}),C=_(()=>u.value.split("/").filter(Boolean).length),d=c(""),m=c(""),p=c(""),h=c([]),N=s=>{const e=s.split("/").filter(Boolean).map(o=>Number(o)).filter(Number.isFinite),t=e.length>0?e[e.length-1]:void 0;return t??null},y=s=>{const e=s.endsWith("/")?s:`${s}/`;i.push({path:e})},$=()=>{i.push({path:`/course-editor${p.value}`})},I=()=>{i.push({path:`/course-preview${p.value}`})};return E(async()=>{v.value=await D(f);const s=N(u.value),e=s!=null?v.value.find(o=>o.id===s&&o.deletedAt===null):null;if(!e||e.type!=="leaf"){i.push({path:"/"});return}p.value=e.path,d.value=e.name;const t=typeof e.objectId=="string"?e.objectId:null;if(t){const o=L(t);o&&o.deletedAt===null&&(d.value=o.fullName||e.name,m.value=o.description||"",h.value=o.structure||[])}}),(s,e)=>(l(),r("div",W,[n("div",G,[P(S,{"forest-id":g(f),path:u.value,onRootClick:e[0]||(e[0]=t=>y("/"))},{item:R(({item:t,index:o})=>[o<C.value-1?(l(),r("button",{key:0,class:"truncate max-w-40 inline-block align-middle hover:underline",onClick:te=>y(t.path)},a(t.name),9,H)):(l(),r("span",K,a(t.name),1))]),_:1},8,["forest-id","path"])]),n("div",U,[n("h1",q,a(d.value),1),m.value?(l(),A(O,{key:0,content:m.value},null,8,["content"])):x("",!0),h.value.length>0?(l(),r("div",J,[n("ul",Q,[(l(!0),r(V,null,z(h.value,t=>(l(),r("li",{key:t.id,class:"flex items-center justify-between px-0 py-2 rounded-md"},[n("span",X,a(t.name),1),n("span",Y,a(t.steps.length),1)]))),128))])])):x("",!0),n("div",Z,[n("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",onClick:$},a(g(b)("common.edit")),1),n("button",{type:"button",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700",onClick:I},a(g(b)("common.preview")),1)])])]))}});export{re as default};
